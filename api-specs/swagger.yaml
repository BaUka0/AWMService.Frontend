openapi: 3.0.3
info:
  title: AWMService API
  description: |
    API для системы управления выпускными работами (AWMService)
    
    ## Роли пользователей
    - **department** - Кафедра (администрирование)
    - **supervisor** - Научный руководитель
    - **student** - Студент
    
    ## Статусы
    ### Направления и темы
    - `draft` - Черновик
    - `pending` - На рассмотрении
    - `approved` - Утверждено
    - `rejected` - Отклонено
    
    ### Заявки студентов
    - `pending` - Ожидает рассмотрения
    - `approved` - Одобрено
    - `rejected` - Отклонено
    
    ### Этапы проверки
    - `in_progress` - В процессе
    - `failed` - Не пройдено
    - `success` - Пройдено
  version: 1.0.0
  contact:
    name: AWMService Support
    email: support@awmservice.kz

servers:
  - url: /api/v1
    description: Production server
  - url: http://localhost:3000/api/v1
    description: Development server

tags:
  - name: Auth
    description: Аутентификация и авторизация
  - name: Users
    description: Пользователи
  - name: Supervisors
    description: Научные руководители
  - name: Time Periods
    description: Временные периоды
  - name: Commissions
    description: Комиссии
  - name: Directions
    description: Направления
  - name: Topics
    description: Темы выпускных работ
  - name: Applications
    description: Заявки студентов
  - name: Files
    description: Файлы
  - name: Defense Steps
    description: Этапы защиты
  - name: Reviews
    description: Рецензирование
  - name: Antiplagiarism
    description: Антиплагиат
  - name: Critique
    description: Рецензия
  - name: Supervisor Students
    description: Студенты руководителя
  - name: Schedule
    description: Расписание
  - name: Journal
    description: Журнал оценок
  - name: Checks
    description: Проверка работ
  - name: Secretary
    description: Панель секретаря

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    # ========== Base Models ==========
    User:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        email:
          type: string
          format: email
        role:
          type: string
          enum: [department, supervisor, student]
      required:
        - id
        - name
        - email
        - role

    MultiLanguageText:
      type: object
      properties:
        ru:
          type: string
        kz:
          type: string
        en:
          type: string
      required:
        - ru
        - kz
        - en

    # ========== Auth ==========
    LoginRequest:
      type: object
      properties:
        email:
          type: string
          format: email
        password:
          type: string
          format: password
      required:
        - email
        - password

    LoginResponse:
      type: object
      properties:
        token:
          type: string
        user:
          $ref: '#/components/schemas/User'
      required:
        - token
        - user

    # ========== Supervisors ==========
    Supervisor:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        position:
          type: string
        degree:
          type: string
        specialization:
          type: string
        email:
          type: string
          format: email
        phone:
          type: string
        currentStudents:
          type: integer
        maxStudents:
          type: integer
        assignedDate:
          type: string
          format: date-time
      required:
        - id
        - name
        - position
        - email
        - currentStudents
        - maxStudents

    AddSupervisorsRequest:
      type: object
      properties:
        teacherIds:
          type: array
          items:
            type: string
            format: uuid
      required:
        - teacherIds

    UpdateWorkloadRequest:
      type: object
      properties:
        maxStudents:
          type: integer
          minimum: 1
      required:
        - maxStudents

    # ========== Time Periods ==========
    TimePeriod:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        commissionsCount:
          type: integer
        studentsCount:
          type: integer
      required:
        - id
        - name
        - startDate
        - endDate

    TimePeriodDetail:
      allOf:
        - $ref: '#/components/schemas/TimePeriod'
        - type: object
          properties:
            commissions:
              type: array
              items:
                $ref: '#/components/schemas/Commission'

    CreateTimePeriodRequest:
      type: object
      properties:
        name:
          type: string
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
      required:
        - name
        - startDate
        - endDate

    # ========== Commissions ==========
    Commission:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        chairman:
          type: string
        secretary:
          type: string
        members:
          type: array
          items:
            type: string
        sessions:
          type: array
          items:
            $ref: '#/components/schemas/Session'
      required:
        - id
        - name
        - chairman
        - secretary
        - members

    Session:
      type: object
      properties:
        sessionId:
          type: string
          format: uuid
        date:
          type: string
          format: date
        time:
          type: string
          format: time
        room:
          type: string
        students:
          type: array
          items:
            type: string
            format: uuid
      required:
        - sessionId
        - date
        - time

    CreateCommissionRequest:
      type: object
      properties:
        name:
          type: string
        chairman:
          type: string
        secretary:
          type: string
        members:
          type: array
          items:
            type: string
            format: uuid
      required:
        - name
        - chairman
        - secretary
        - members

    CreateSessionRequest:
      type: object
      properties:
        date:
          type: string
          format: date
        time:
          type: string
          format: time
        room:
          type: string
      required:
        - date
        - time

    DistributeStudentsRequest:
      type: object
      properties:
        studentIds:
          type: array
          items:
            type: string
            format: uuid
      required:
        - studentIds

    # ========== Directions ==========
    Direction:
      type: object
      properties:
        id:
          type: string
          format: uuid
        title:
          $ref: '#/components/schemas/MultiLanguageText'
        description:
          $ref: '#/components/schemas/MultiLanguageText'
        status:
          type: string
          enum: [draft, pending, approved, rejected]
        supervisor:
          type: string
        submittedAt:
          type: string
          format: date-time
        rejectionReason:
          type: string
      required:
        - id
        - title
        - description
        - status

    UpdateDirectionStatusRequest:
      type: object
      properties:
        status:
          type: string
          enum: [approved, rejected]
        rejectionReason:
          type: string
      required:
        - status

    # ========== Topics ==========
    Topic:
      type: object
      properties:
        id:
          type: string
          format: uuid
        directionTitle:
          type: string
        title:
          $ref: '#/components/schemas/MultiLanguageText'
        description:
          $ref: '#/components/schemas/MultiLanguageText'
        workType:
          type: string
        participantCount:
          type: integer
        status:
          type: string
          enum: [draft, pending, approved, rejected]
        students:
          type: array
          items:
            $ref: '#/components/schemas/Student'
        requests:
          type: array
          items:
            $ref: '#/components/schemas/TopicRequest'
        rejectionReason:
          type: string
      required:
        - id
        - directionTitle
        - title
        - description
        - workType
        - status

    TopicRequest:
      type: object
      properties:
        id:
          type: string
          format: uuid
        studentId:
          type: string
          format: uuid
        studentName:
          type: string
        status:
          type: string
          enum: [pending, approved, rejected]
        submittedAt:
          type: string
          format: date-time
        rejectionReason:
          type: string

    CreateTopicRequest:
      type: object
      properties:
        direction:
          type: string
          format: uuid
        title:
          $ref: '#/components/schemas/MultiLanguageText'
        description:
          $ref: '#/components/schemas/MultiLanguageText'
        workType:
          type: string
        studentCount:
          type: integer
          minimum: 1
      required:
        - direction
        - title
        - description
        - workType
        - studentCount

    UpdateTopicStatusRequest:
      type: object
      properties:
        status:
          type: string
          enum: [approved, rejected]
        rejectionReason:
          type: string
      required:
        - status

    RejectRequestRequest:
      type: object
      properties:
        reason:
          type: string
      required:
        - reason

    # ========== Applications ==========
    StudentApplication:
      type: object
      properties:
        id:
          type: string
          format: uuid
        topicId:
          type: string
          format: uuid
        topicTitle:
          type: string
        supervisor:
          type: string
        status:
          type: string
          enum: [pending, approved, rejected]
        submittedAt:
          type: string
          format: date-time
        rejectionReason:
          type: string

    AvailableTopic:
      type: object
      properties:
        id:
          type: string
          format: uuid
        title:
          type: string
        supervisor:
          type: string
        availableSlots:
          type: integer
        direction:
          type: string
        status:
          type: string

    # ========== Files ==========
    FileUploadResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        url:
          type: string
          format: uri
        size:
          type: integer
        uploadedAt:
          type: string
          format: date-time
      required:
        - id
        - name
        - url
        - size

    StudentFile:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        url:
          type: string
          format: uri
        uploadedAt:
          type: string
          format: date-time
        uploadedBy:
          type: string

    # ========== Defense Steps ==========
    DefenseStep:
      type: object
      properties:
        type:
          type: string
          enum: [defense, predefense]
        status:
          type: string
          enum: [in_progress, failed, success]
        schedule:
          $ref: '#/components/schemas/Session'
        commission:
          $ref: '#/components/schemas/Commission'
        results:
          $ref: '#/components/schemas/DefenseResults'
        files:
          type: array
          items:
            $ref: '#/components/schemas/FileUploadResponse'

    DefenseResults:
      type: object
      properties:
        finalScore:
          type: number
          format: float
        finalGrade:
          type: string
        comments:
          type: string
        readiness:
          type: boolean

    SubmitStepRequest:
      type: object
      properties:
        fileId:
          type: string
          format: uuid
      required:
        - fileId

    # ========== Reviews ==========
    Review:
      type: object
      properties:
        type:
          type: string
          enum: [normcontrol, software]
        expert:
          type: string
        status:
          type: string
          enum: [in_progress, failed, success]
        period:
          $ref: '#/components/schemas/TimePeriod'
        comments:
          type: string
        files:
          type: array
          items:
            $ref: '#/components/schemas/FileUploadResponse'

    ReviewComments:
      type: object
      properties:
        comments:
          type: string

    # ========== Antiplagiarism ==========
    AntiplagiarismStatus:
      type: object
      properties:
        status:
          type: string
          enum: [in_progress, failed, success]
        originality:
          type: number
          format: float
          minimum: 0
          maximum: 100
        comments:
          type: string
        file:
          $ref: '#/components/schemas/FileUploadResponse'
        period:
          $ref: '#/components/schemas/TimePeriod'

    AntiplagiarismResult:
      type: object
      properties:
        originality:
          type: number
          format: float
        status:
          type: string
        reportUrl:
          type: string
          format: uri

    CheckAntiplagiarismRequest:
      type: object
      properties:
        fileId:
          type: string
          format: uuid
      required:
        - fileId

    # ========== Critique ==========
    CritiqueData:
      type: object
      properties:
        reviewer:
          type: string
        period:
          $ref: '#/components/schemas/TimePeriod'
        materials:
          type: array
          items:
            $ref: '#/components/schemas/FileUploadResponse'
        status:
          type: string
          enum: [pending, in_progress, completed]
        reviewFile:
          $ref: '#/components/schemas/FileUploadResponse'

    # ========== Supervisor Students ==========
    SupervisorStudent:
      type: object
      properties:
        id:
          type: string
          format: uuid
        topic:
          type: string
        stage:
          type: string
        students:
          type: array
          items:
            $ref: '#/components/schemas/Student'
        projectFiles:
          type: array
          items:
            $ref: '#/components/schemas/FileUploadResponse'
        supervisorFiles:
          type: array
          items:
            $ref: '#/components/schemas/FileUploadResponse'
        notes:
          type: array
          items:
            $ref: '#/components/schemas/SupervisorNote'
        scores:
          type: object
          additionalProperties:
            type: number

    Student:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        email:
          type: string
        group:
          type: string

    SupervisorNote:
      type: object
      properties:
        id:
          type: string
          format: uuid
        text:
          type: string
        createdAt:
          type: string
          format: date-time
        createdBy:
          type: string

    AddNoteRequest:
      type: object
      properties:
        text:
          type: string
      required:
        - text

    UpdateScoresRequest:
      type: object
      properties:
        scores:
          type: object
          additionalProperties:
            type: number

    # ========== Schedule ==========
    ScheduleItem:
      type: object
      properties:
        id:
          type: string
          format: uuid
        type:
          type: string
          enum: [commission, consultation, exam]
        stage:
          type: string
        chairman:
          type: string
        secretary:
          type: string
        members:
          type: array
          items:
            type: string
        date:
          type: string
          format: date
        time:
          type: string
          format: time
        room:
          type: string

    CommissionStudent:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        topic:
          type: string
        readiness:
          type: boolean

    # ========== Journal ==========
    Journal:
      type: object
      properties:
        students:
          type: array
          items:
            $ref: '#/components/schemas/CommissionStudent'
        criteria:
          type: array
          items:
            $ref: '#/components/schemas/Criteria'

    Criteria:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        maxScore:
          type: integer

    JournalScoresRequest:
      type: object
      properties:
        scores:
          type: object
          additionalProperties:
            type: number

    JournalAverageResponse:
      type: object
      properties:
        averageScore:
          type: number
          format: float

    # ========== Checks ==========
    CheckTopic:
      type: object
      properties:
        topicId:
          type: string
          format: uuid
        topicName:
          type: string
        isClosed:
          type: boolean
        students:
          type: array
          items:
            $ref: '#/components/schemas/CheckStudent'

    CheckStudent:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        status:
          type: string
          enum: [ожидание, зачет, незачет]
        file:
          $ref: '#/components/schemas/FileUploadResponse'

    SetCheckStatusRequest:
      type: object
      properties:
        status:
          type: string
          enum: [ожидание, зачет, незачет]
      required:
        - status

    # ========== Secretary ==========
    SecretaryCommission:
      type: object
      properties:
        students:
          type: array
          items:
            $ref: '#/components/schemas/SecretaryStudent'

    SecretaryStudent:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        globalStatus:
          type: string
          enum: [gathering, ready_to_reveal, reviewing, ready_to_lock, completed]
        averageScore:
          type: number
          format: float

    # ========== Error Response ==========
    ErrorResponse:
      type: object
      properties:
        statusCode:
          type: integer
        message:
          type: string
        error:
          type: string
        timestamp:
          type: string
          format: date-time
      required:
        - statusCode
        - message

security:
  - BearerAuth: []

paths:
  # ========== Auth ==========
  /auth/login:
    post:
      tags:
        - Auth
      summary: Вход в систему
      description: Аутентификация пользователя и получение JWT токена
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Успешный вход
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '401':
          description: Неверный email или пароль
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /users/me:
    get:
      tags:
        - Users
      summary: Данные текущего пользователя
      description: Получение информации о текущем авторизованном пользователе
      responses:
        '200':
          description: Успешное получение данных
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'

  /teachers:
    get:
      tags:
        - Users
      summary: Список всех преподавателей
      description: Получение списка всех преподавателей для назначения научными руководителями
      responses:
        '200':
          description: Успешное получение списка
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Supervisor'

  # ========== Supervisors ==========
  /supervisors:
    get:
      tags:
        - Supervisors
      summary: Список научных руководителей
      description: Получение списка всех назначенных научных руководителей с их нагрузкой
      responses:
        '200':
          description: Успешное получение списка
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Supervisor'
    post:
      tags:
        - Supervisors
      summary: Назначение руководителей
      description: Назначение преподавателей научными руководителями
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddSupervisorsRequest'
      responses:
        '200':
          description: Руководители успешно назначены
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  added:
                    type: array
                    items:
                      $ref: '#/components/schemas/Supervisor'
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /supervisors/{id}:
    delete:
      tags:
        - Supervisors
      summary: Удаление руководителя
      description: Удаление научного руководителя из системы
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID руководителя
      responses:
        '200':
          description: Руководитель успешно удален
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '404':
          description: Руководитель не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: Нельзя удалить руководителя с активными студентами
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /supervisors/{id}/workload:
    patch:
      tags:
        - Supervisors
      summary: Обновление нагрузки руководителя
      description: Изменение максимального количества студентов для руководителя
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID руководителя
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateWorkloadRequest'
      responses:
        '200':
          description: Нагрузка успешно обновлена
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  supervisor:
                    $ref: '#/components/schemas/Supervisor'
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Руководитель не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ========== Time Periods ==========
  /time-periods:
    get:
      tags:
        - Time Periods
      summary: Список временных периодов
      description: Получение всех временных периодов с краткой информацией
      responses:
        '200':
          description: Успешное получение списка
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TimePeriod'
    post:
      tags:
        - Time Periods
      summary: Создание временного периода
      description: Создание нового временного периода для выпускных работ
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTimePeriodRequest'
      responses:
        '201':
          description: Период успешно создан
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  period:
                    $ref: '#/components/schemas/TimePeriod'
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /time-periods/{id}:
    get:
      tags:
        - Time Periods
      summary: Детали временного периода
      description: Получение полной информации о временном периоде с комиссиями
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID периода
      responses:
        '200':
          description: Успешное получение данных
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TimePeriodDetail'
        '404':
          description: Период не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      tags:
        - Time Periods
      summary: Обновление временного периода
      description: Обновление информации о временном периоде
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID периода
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTimePeriodRequest'
      responses:
        '200':
          description: Период успешно обновлен
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  period:
                    $ref: '#/components/schemas/TimePeriod'
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Период не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      tags:
        - Time Periods
      summary: Удаление временного периода
      description: Удаление временного периода и всех связанных данных
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID периода
      responses:
        '200':
          description: Период успешно удален
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '404':
          description: Период не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: Нельзя удалить период с активными комиссиями
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /time-periods/{periodId}/commissions:
    post:
      tags:
        - Commissions
      summary: Создание комиссии
      description: Создание новой комиссии в рамках временного периода
      parameters:
        - name: periodId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID временного периода
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCommissionRequest'
      responses:
        '201':
          description: Комиссия успешно создана
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  commission:
                    $ref: '#/components/schemas/Commission'
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Период не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /commissions/{id}:
    put:
      tags:
        - Commissions
      summary: Обновление комиссии
      description: Обновление информации о комиссии
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID комиссии
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCommissionRequest'
      responses:
        '200':
          description: Комиссия успешно обновлена
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  commission:
                    $ref: '#/components/schemas/Commission'
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Комиссия не найдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      tags:
        - Commissions
      summary: Удаление комиссии
      description: Удаление комиссии и всех связанных данных
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID комиссии
      responses:
        '200':
          description: Комиссия успешно удалена
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '404':
          description: Комиссия не найдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: Нельзя удалить комиссию с распределенными студентами
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /commissions/{id}/sessions:
    post:
      tags:
        - Commissions
      summary: Добавление сессии
      description: Добавление новой сессии (заседания) для комиссии
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID комиссии
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateSessionRequest'
      responses:
        '201':
          description: Сессия успешно создана
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  session:
                    $ref: '#/components/schemas/Session'
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Комиссия не найдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /commissions/{id}/sessions/{sessionId}/students:
    post:
      tags:
        - Commissions
      summary: Распределение студентов на сессию
      description: Ручное распределение студентов на конкретную сессию
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID комиссии
        - name: sessionId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID сессии
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DistributeStudentsRequest'
      responses:
        '200':
          description: Студенты успешно распределены
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Комиссия или сессия не найдены
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /commissions/{id}/distribute:
    post:
      tags:
        - Commissions
      summary: Автоматическое распределение студентов
      description: Автоматическое распределение студентов по сессиям комиссии
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID комиссии
      responses:
        '200':
          description: Студенты успешно распределены
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '400':
          description: Ошибка распределения (недостаточно сессий)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Комиссия не найдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ========== Directions ==========
  /directions:
    get:
      tags:
        - Directions
      summary: Список направлений
      description: Получение списка всех направлений с фильтрацией
      parameters:
        - name: status
          in: query
          required: false
          schema:
            type: string
            enum: [draft, pending, approved, rejected]
          description: Фильтр по статусу
        - name: search
          in: query
          required: false
          schema:
            type: string
          description: Поиск по названию
        - name: supervisor
          in: query
          required: false
          schema:
            type: string
            format: uuid
          description: Фильтр по руководителю
      responses:
        '200':
          description: Успешное получение списка
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Direction'
    post:
      tags:
        - Directions
      summary: Создание направления
      description: Создание нового направления выпускных работ
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - title
                - description
              properties:
                title:
                  $ref: '#/components/schemas/MultiLanguageText'
                description:
                  $ref: '#/components/schemas/MultiLanguageText'
      responses:
        '201':
          description: Направление успешно создано
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  direction:
                    $ref: '#/components/schemas/Direction'
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /directions/{id}:
    get:
      tags:
        - Directions
      summary: Детали направления
      description: Получение полной информации о направлении
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID направления
      responses:
        '200':
          description: Успешное получение данных
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Direction'
        '404':
          description: Направление не найдено
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /directions/{id}/status:
    patch:
      tags:
        - Directions
      summary: Обновление статуса направления
      description: Утверждение или отклонение направления (только для кафедры)
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID направления
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateDirectionStatusRequest'
      responses:
        '200':
          description: Статус успешно обновлен
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  direction:
                    $ref: '#/components/schemas/Direction'
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Направление не найдено
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ========== Topics ==========
  /topics:
    get:
      tags:
        - Topics
      summary: Список тем
      description: Получение списка всех тем с фильтрацией
      parameters:
        - name: status
          in: query
          required: false
          schema:
            type: string
            enum: [draft, pending, approved, rejected]
          description: Фильтр по статусу
        - name: direction
          in: query
          required: false
          schema:
            type: string
            format: uuid
          description: Фильтр по направлению
        - name: search
          in: query
          required: false
          schema:
            type: string
          description: Поиск по названию
      responses:
        '200':
          description: Успешное получение списка
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Topic'
    post:
      tags:
        - Topics
      summary: Создание темы
      description: Создание новой темы выпускной работы
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTopicRequest'
      responses:
        '201':
          description: Тема успешно создана
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  topic:
                    $ref: '#/components/schemas/Topic'
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /topics/available:
    get:
      tags:
        - Topics
      summary: Доступные темы для студента
      description: Получение списка тем, доступных для подачи заявки студентом
      parameters:
        - name: search
          in: query
          required: false
          schema:
            type: string
          description: Поиск по названию
        - name: direction
          in: query
          required: false
          schema:
            type: string
            format: uuid
          description: Фильтр по направлению
        - name: supervisor
          in: query
          required: false
          schema:
            type: string
            format: uuid
          description: Фильтр по руководителю
      responses:
        '200':
          description: Успешное получение списка
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AvailableTopic'

  /topics/{id}:
    get:
      tags:
        - Topics
      summary: Детали темы
      description: Получение полной информации о теме с заявками студентов
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID темы
      responses:
        '200':
          description: Успешное получение данных
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Topic'
        '404':
          description: Тема не найдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      tags:
        - Topics
      summary: Обновление темы
      description: Обновление информации о теме (только черновик)
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID темы
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTopicRequest'
      responses:
        '200':
          description: Тема успешно обновлена
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  topic:
                    $ref: '#/components/schemas/Topic'
        '400':
          description: Ошибка валидации или тема не в статусе черновика
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Тема не найдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /topics/{id}/status:
    patch:
      tags:
        - Topics
      summary: Обновление статуса темы
      description: Отправка на рассмотрение, утверждение или отклонение темы
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID темы
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateTopicStatusRequest'
      responses:
        '200':
          description: Статус успешно обновлен
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  topic:
                    $ref: '#/components/schemas/Topic'
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Тема не найдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /topics/{topicId}/apply:
    post:
      tags:
        - Applications
      summary: Подача заявки на тему
      description: Подача заявки студентом на выбранную тему
      parameters:
        - name: topicId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID темы
      responses:
        '201':
          description: Заявка успешно подана
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  application:
                    $ref: '#/components/schemas/StudentApplication'
        '400':
          description: Ошибка (уже есть активная заявка, нет мест)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Тема не найдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /topics/{topicId}/requests/{requestId}/approve:
    post:
      tags:
        - Topics
      summary: Одобрение заявки студента
      description: Одобрение заявки студента на тему руководителем
      parameters:
        - name: topicId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID темы
        - name: requestId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID заявки
      responses:
        '200':
          description: Заявка успешно одобрена
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  topic:
                    $ref: '#/components/schemas/Topic'
        '400':
          description: Ошибка (нет мест, заявка уже обработана)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Тема или заявка не найдены
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /topics/{topicId}/requests/{requestId}/reject:
    post:
      tags:
        - Topics
      summary: Отклонение заявки студента
      description: Отклонение заявки студента на тему руководителем
      parameters:
        - name: topicId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID темы
        - name: requestId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID заявки
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RejectRequestRequest'
      responses:
        '200':
          description: Заявка успешно отклонена
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  topic:
                    $ref: '#/components/schemas/Topic'
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Тема или заявка не найдены
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ========== Applications ==========
  /student/applications:
    get:
      tags:
        - Applications
      summary: Мои заявки
      description: Получение списка всех поданных заявок студента
      responses:
        '200':
          description: Успешное получение списка
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/StudentApplication'

  /applications/{id}:
    delete:
      tags:
        - Applications
      summary: Отмена заявки
      description: Отмена поданной заявки студентом (только pending)
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID заявки
      responses:
        '200':
          description: Заявка успешно отменена
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '400':
          description: Нельзя отменить обработанную заявку
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Заявка не найдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /applications/{id}/reapply:
    post:
      tags:
        - Applications
      summary: Повторная заявка
      description: Повторная подача заявки после отклонения
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID заявки
      responses:
        '200':
          description: Заявка успешно подана повторно
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  application:
                    $ref: '#/components/schemas/StudentApplication'
        '400':
          description: Ошибка (заявка не отклонена, нет мест)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Заявка не найдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ========== Files ==========
  /files/upload:
    post:
      tags:
        - Files
      summary: Загрузка файла
      description: Загрузка файла на сервер
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                type:
                  type: string
                  enum: [diploma, presentation, review, report, other]
                stage:
                  type: string
                  enum: [defense, predefense, normcontrol, software, antiquagiarism, critique]
              required:
                - file
                - type
      responses:
        '201':
          description: Файл успешно загружен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FileUploadResponse'
        '400':
          description: Ошибка валидации (неверный тип файла, размер)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /files/{id}:
    get:
      tags:
        - Files
      summary: Скачивание файла
      description: Получение файла по ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID файла
      responses:
        '200':
          description: Файл успешно получен
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
        '404':
          description: Файл не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      tags:
        - Files
      summary: Удаление файла
      description: Удаление файла по ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID файла
      responses:
        '200':
          description: Файл успешно удален
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '404':
          description: Файл не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /students/{studentId}/files:
    get:
      tags:
        - Files
      summary: Файлы студента
      description: Получение списка всех файлов студента
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
      responses:
        '200':
          description: Успешное получение списка
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/StudentFile'
        '404':
          description: Студент не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ========== Defense Steps ==========
  /students/{studentId}/steps:
    get:
      tags:
        - Defense Steps
      summary: Этапы студента
      description: Получение информации обо всех этапах студента (защита/предзащита)
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
      responses:
        '200':
          description: Успешное получение данных
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DefenseStep'
        '404':
          description: Студент не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /students/{studentId}/steps/{stepType}/submit:
    post:
      tags:
        - Defense Steps
      summary: Загрузка работы на этап
      description: Загрузка дипломной работы или презентации на этап защиты
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
        - name: stepType
          in: path
          required: true
          schema:
            type: string
            enum: [defense, predefense]
          description: Тип этапа
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubmitStepRequest'
      responses:
        '201':
          description: Работа успешно загружена
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  submission:
                    $ref: '#/components/schemas/DefenseStep'
        '400':
          description: Ошибка (этап завершен, неверный тип файла)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Студент или этап не найдены
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /students/{studentId}/steps/{stepType}/results:
    get:
      tags:
        - Defense Steps
      summary: Результаты этапа
      description: Получение результатов этапа защиты
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
        - name: stepType
          in: path
          required: true
          schema:
            type: string
            enum: [defense, predefense]
          description: Тип этапа
      responses:
        '200':
          description: Успешное получение результатов
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DefenseResults'
        '404':
          description: Студент или этап не найдены
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ========== Reviews ==========
  /students/{studentId}/reviews:
    get:
      tags:
        - Reviews
      summary: Рецензии студента
      description: Получение информации о всех рецензиях студента (нормоконтроль, проверка ПО)
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
      responses:
        '200':
          description: Успешное получение данных
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Review'
        '404':
          description: Студент не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /students/{studentId}/reviews/{reviewType}/submit:
    post:
      tags:
        - Reviews
      summary: Загрузка на проверку
      description: Загрузка работы на проверку эксперту (нормоконтроль или ПО)
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
        - name: reviewType
          in: path
          required: true
          schema:
            type: string
            enum: [normcontrol, software]
          description: Тип проверки
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubmitStepRequest'
      responses:
        '201':
          description: Работа успешно загружена на проверку
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  review:
                    $ref: '#/components/schemas/Review'
        '400':
          description: Ошибка (проверка уже пройдена)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Студент или тип проверки не найдены
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /students/{studentId}/reviews/{reviewType}/comments:
    get:
      tags:
        - Reviews
      summary: Замечания эксперта
      description: Получение замечаний эксперта по проверке
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
        - name: reviewType
          in: path
          required: true
          schema:
            type: string
            enum: [normcontrol, software]
          description: Тип проверки
      responses:
        '200':
          description: Успешное получение замечаний
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReviewComments'
        '404':
          description: Студент или проверка не найдены
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ========== Antiplagiarism ==========
  /students/{studentId}/antiplagiarism:
    get:
      tags:
        - Antiplagiarism
      summary: Статус антиплагиата
      description: Получение текущего статуса проверки на антиплагиат
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
      responses:
        '200':
          description: Успешное получение статуса
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AntiplagiarismStatus'
        '404':
          description: Студент не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /students/{studentId}/antiplagiarism/check:
    post:
      tags:
        - Antiplagiarism
      summary: Загрузка на проверку антиплагиата
      description: Загрузка работы на проверку системы антиплагиата
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CheckAntiplagiarismRequest'
      responses:
        '201':
          description: Работа успешно загружена на проверку
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  checkId:
                    type: string
                    format: uuid
        '400':
          description: Ошибка (проверка уже пройдена)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Студент не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /antiplagiarism/{checkId}/result:
    get:
      tags:
        - Antiplagiarism
      summary: Результат проверки антиплагиата
      description: Получение результата проверки на антиплагиат
      parameters:
        - name: checkId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID проверки
      responses:
        '200':
          description: Успешное получение результата
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AntiplagiarismResult'
        '404':
          description: Проверка не найдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /students/{studentId}/antiplagiarism/report:
    get:
      tags:
        - Antiplagiarism
      summary: Скачивание отчета антиплагиата
      description: Скачивание PDF отчета о проверке на антиплагиат
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
      responses:
        '200':
          description: Отчет успешно получен
          content:
            application/pdf:
              schema:
                type: string
                format: binary
        '404':
          description: Отчет не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ========== Critique ==========
  /students/{studentId}/critique:
    get:
      tags:
        - Critique
      summary: Данные рецензии
      description: Получение информации о рецензии и материалах
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
      responses:
        '200':
          description: Успешное получение данных
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CritiqueData'
        '404':
          description: Студент не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /students/{studentId}/critique/submit:
    post:
      tags:
        - Critique
      summary: Загрузка отзыва рецензента
      description: Загрузка отзыва рецензента студентом
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubmitStepRequest'
      responses:
        '201':
          description: Отзыв успешно загружен
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  critique:
                    $ref: '#/components/schemas/CritiqueData'
        '400':
          description: Ошибка (рецензия уже загружена)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Студент не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ========== Supervisor Students ==========
  /supervisor/students:
    get:
      tags:
        - Supervisor Students
      summary: Мои студенты
      description: Получение списка всех студентов руководителя
      responses:
        '200':
          description: Успешное получение списка
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SupervisorStudent'

  /supervisor/students/{studentId}:
    get:
      tags:
        - Supervisor Students
      summary: Детали студента
      description: Получение полной информации о студенте руководителя
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
      responses:
        '200':
          description: Успешное получение данных
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SupervisorStudent'
        '404':
          description: Студент не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /supervisor/students/{studentId}/files:
    post:
      tags:
        - Supervisor Students
      summary: Загрузка файла руководителя
      description: Загрузка файла руководителем для студента
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
              required:
                - file
      responses:
        '201':
          description: Файл успешно загружен
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  file:
                    $ref: '#/components/schemas/FileUploadResponse'
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Студент не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /supervisor/students/{studentId}/notes:
    post:
      tags:
        - Supervisor Students
      summary: Добавление замечания
      description: Добавление замечания руководителем для студента
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddNoteRequest'
      responses:
        '201':
          description: Замечание успешно добавлено
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  note:
                    $ref: '#/components/schemas/SupervisorNote'
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Студент не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /supervisor/students/{studentId}/scores:
    put:
      tags:
        - Supervisor Students
      summary: Обновление оценок
      description: Обновление оценок студента руководителем
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateScoresRequest'
      responses:
        '200':
          description: Оценки успешно обновлены
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Студент не найден
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ========== Schedule ==========
  /schedule:
    get:
      tags:
        - Schedule
      summary: Расписание комиссий
      description: Получение расписания комиссий с фильтрацией по дате
      parameters:
        - name: date
          in: query
          required: false
          schema:
            type: string
            format: date
          description: Фильтр по дате
      responses:
        '200':
          description: Успешное получение расписания
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ScheduleItem'

  /schedule/{commissionId}/students:
    get:
      tags:
        - Schedule
      summary: Студенты комиссии
      description: Получение списка студентов, распределенных на комиссию
      parameters:
        - name: commissionId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID комиссии
      responses:
        '200':
          description: Успешное получение списка
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CommissionStudent'
        '404':
          description: Комиссия не найдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ========== Journal ==========
  /commissions/{commissionId}/journal:
    get:
      tags:
        - Journal
      summary: Журнал комиссии
      description: Получение журнала оценок комиссии с критериями
      parameters:
        - name: commissionId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID комиссии
      responses:
        '200':
          description: Успешное получение журнала
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Journal'
        '404':
          description: Комиссия не найдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /commissions/{commissionId}/journal/{studentId}/scores:
    post:
      tags:
        - Journal
      summary: Оценка студента
      description: Выставление оценок студенту по критериям
      parameters:
        - name: commissionId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID комиссии
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/JournalScoresRequest'
      responses:
        '200':
          description: Оценки успешно выставлены
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  totalScore:
                    type: number
                    format: float
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Комиссия или студент не найдены
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /commissions/{commissionId}/journal/{studentId}/submit:
    post:
      tags:
        - Journal
      summary: Отправка оценки
      description: Отправка оценки студента (финализация членом комиссии)
      parameters:
        - name: commissionId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID комиссии
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
      responses:
        '200':
          description: Оценка успешно отправлена
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '400':
          description: Ошибка (оценка уже отправлена)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Комиссия или студент не найдены
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /commissions/{commissionId}/journal/{studentId}/finalize:
    post:
      tags:
        - Journal
      summary: Финализация оценки
      description: Финализация оценки студента (председатель комиссии)
      parameters:
        - name: commissionId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID комиссии
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
      responses:
        '200':
          description: Оценка успешно финализирована
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  finalScore:
                    type: number
                    format: float
        '400':
          description: Ошибка (не все оценки отправлены)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Комиссия или студент не найдены
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /commissions/{commissionId}/journal/{studentId}/average:
    get:
      tags:
        - Journal
      summary: Средний балл комиссии
      description: Получение среднего балла студента по оценкам комиссии
      parameters:
        - name: commissionId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID комиссии
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
      responses:
        '200':
          description: Успешное получение среднего балла
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JournalAverageResponse'
        '404':
          description: Комиссия или студент не найдены
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ========== Checks ==========
  /checks/antiplagiarism:
    get:
      tags:
        - Checks
      summary: Dashboard проверок антиплагиата
      description: Получение списка тем и студентов для проверки антиплагиата
      responses:
        '200':
          description: Успешное получение данных
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CheckTopic'

  /checks/antiplagiarism/{topicId}/{studentId}/status:
    post:
      tags:
        - Checks
      summary: Установка статуса проверки
      description: Установка статуса проверки работы студента
      parameters:
        - name: topicId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID темы
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SetCheckStatusRequest'
      responses:
        '200':
          description: Статус успешно установлен
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Тема или студент не найдены
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /checks/antiplagiarism/{topicId}/{studentId}/file:
    post:
      tags:
        - Checks
      summary: Загрузка файла за студента
      description: Загрузка работы на проверку за студента (кафедра)
      parameters:
        - name: topicId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID темы
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID студента
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
              required:
                - file
      responses:
        '201':
          description: Файл успешно загружен
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Тема или студент не найдены
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /checks/antiplagiarism/{topicId}/close:
    post:
      tags:
        - Checks
      summary: Закрытие темы
      description: Закрытие темы для проверки антиплагиата
      parameters:
        - name: topicId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID темы
      responses:
        '200':
          description: Тема успешно закрыта
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '400':
          description: Ошибка (не все студенты проверены)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Тема не найдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ========== Secretary ==========
  /secretary/commissions/{commissionId}:
    get:
      tags:
        - Secretary
      summary: Данные комиссии для секретаря
      description: Получение списка студентов комиссии со статусами для секретаря
      parameters:
        - name: commissionId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID комиссии
      responses:
        '200':
          description: Успешное получение данных
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SecretaryCommission'
        '404':
          description: Комиссия не найдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /secretary/commissions/{commissionId}/publish:
    post:
      tags:
        - Secretary
      summary: Публикация оценок
      description: Публикация оценок комиссии (секретарь)
      parameters:
        - name: commissionId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID комиссии
      responses:
        '200':
          description: Оценки успешно опубликованы
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '400':
          description: Ошибка (не все оценки финализированы)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Комиссия не найдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /secretary/commissions/{commissionId}/finalize:
    post:
      tags:
        - Secretary
      summary: Утверждение протокола
      description: Утверждение протокола заседания комиссии (секретарь)
      parameters:
        - name: commissionId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID комиссии
      responses:
        '200':
          description: Протокол успешно утвержден
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '400':
          description: Ошибка (не все студенты оценены)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Комиссия не найдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
